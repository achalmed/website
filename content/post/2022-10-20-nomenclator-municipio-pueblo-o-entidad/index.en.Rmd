---
title: Nomenclator-municipio-pueblo-o-entidad
author: Edison Achalma
date: '2022-10-20'
slug: nomenclator-municipio-pueblo-o-entidad
categories:
  - municipo
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2022-10-20T23:53:22-05:00'
featured: no
draft: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---



```{r setup, include=FALSE}
library(formatR)
knitr::opts_chunk$set(
  #code_folding = FALSE,
  echo = FALSE, warning = FALSE, message = FALSE,
  comment = "#>", results = "hold",
  collapse = TRUE,  fig.show = "hold", fig.asp = 0.618, fig.width = 6, out.width = "70%", fig.align = "center",
  R.options = list(width = 70) #- Keeping R code and output at 70 characters wide (or less) is recommended for readability on a variety of devices and screen sizes.
)
```

```{r options_setup, include = FALSE}
options(scipen = 999) #- para quitar la notaci√≥n cient√≠fica
```

```{r xaringanExtra-clipboard, include = FALSE}
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clipboard\"></i>",
    success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>",
  ),
  rmarkdown::html_dependency_font_awesome()
)
```

## Nomenclator del INE

En este post voy a hablar de otra operaci√≥n estad√≠stica del INE: el Nomenclator. ¬øQue por qu√© me interesa el Nomenclator? Pues porque quiero saber cuantos habitantes tiene mi pueblo. Mi pueblo es [Pancrudo](https://es.wikipedia.org/wiki/Pancrudo), pero en realidad la palabra pueblo, que mucha gente emplea para referirse a una localidad con pocos habitantes, es seg√∫n la [Wikipedia](https://es.wikipedia.org/wiki/Pueblo), un t√©rmino ambiguo. 

El INE no ofrece datos ni para pueblos ni para localidades, el INE ofrece datos de poblaci√≥n para [municipios](https://es.wikipedia.org/wiki/Municipio). Perfecto, porque en el post anterior arreglaste los datos de poblaci√≥n para municipios. Es verdad, pero a pesar de que s√≠ que existe el municipio de Pancrudo, mi pueblo, no es un municipio. Trato de explicarlo.

Existe el municipio de [Pancrudo](https://es.wikipedia.org/wiki/Pancrudo), s√≠, pero est√° compuesto de 4 localidades o pueblos: [Cervera del Rinc√≥n](https://es.wikipedia.org/wiki/Cervera_del_Rinc%C3%B3n), [Cuevas de Portalrubio](https://es.wikipedia.org/wiki/Cuevas_de_Portalrubio), [Portalrubio](https://es.wikipedia.org/wiki/Portalrubio) y Pancrudo. Es decir, mi pueblo (Pancrudo) es una de las 4 localidades o pueblos del municipio tambi√©n llamado Pancrudo. Un poco de l√≠o!!

Por lo tanto, si quiero saber cuantos habitantes tiene mi pueblo no me vale con los datos que utilic√© en el post anterior, tengo que ir al Nomenclator del INE. Como podemos leer [aqu√≠](https://www.ine.es/dyngs/INEbase/es/operacion.htm?c=Estadistica_C&cid=1254736177010&menu=resultados&idp=1254734710990), El Nomencl√°tor^[O Poblaci√≥n del Padr√≥n Continuo por unidad poblacional] contiene la relaci√≥n detallada de las entidades y n√∫cleos de poblaci√≥n existentes a 1 de enero en cada municipio, as√≠ como su poblaci√≥n. Perfecto, parece que en el Nomenclator s√≠ que aparecer√° la poblaci√≥n de mi pueblo. En realidad el Nomenclator no utiliza el t√©rmino pueblo sino que para el Nomenclator mi pueblo ser√° una entidad o n√∫cleo de poblaci√≥n. Bueno eso me da igual, vamos a por los datos.


La verdad es que me complico las cosas, con lo f√°cil que es buscar en El INE los habitantes de un **municipio** en los diferentes censos. Por ejemplo, [aqu√≠](https://www.ine.es/intercensal/intercensal.do?search=1&error1=Debe+introducir+un+nombre+de+municipio.&error2=Debe+introducir+al+menos+3+caracteres.&cmbTipoBusq=0&textoMunicipio=Pancrudo&btnBuscarDenom=Consultar+selecci%C3%B3n) est√° la b√∫squeda para el **municipio** de Pancrudo. En las notas al pie de la tabla nos dice que en el censo de 1970 el municipio de Pancrudo ya incorpora a Cervera y Cuevas, y que en el censo de 1981 se incorpora Portalrubio. Viendo los datos de la tabla se aprecia que, al menos para Pancrudo, el fen√≥meno de la progresiva despoblaci√≥n de la Espa√±a rural parece empezar en los 60. Los dem√≥grafos dir√°n!!

### Los datos 

Los datos del Nomenclator est√°n [aqu√≠](https://www.ine.es/nomen2/ficheros.do). El INE ofrece un fichero .zip para cada a√±o desde 2010 a 2020. Dentro del .zip hay 2 ficheros^[Un fichero .txt y otro .xlsx] con la misma informaci√≥n: el c√≥digo, el nombre y la poblaci√≥n total y por genero de cada entidad o n√∫cleo de poblaci√≥n.


En el dise√±o de registro del Nomenclator puede verse que el c√≥digo de las entidades tiene 11 d√≠gitos: los 2 primeros se corresponden con el c√≥digo provincial y los 3 siguientes con el c√≥digo del municipio; es decir, los 5 primeros d√≠gitos identifican a que municipio pertenece cada entidad.


```{r, echo = FALSE, layout="l-body-outset"}
knitr::include_graphics("./imagenes/nomenclator_ine_disenyo_registro.png")
```


Se aprecia que, adem√°s de [municipios](https://es.wikipedia.org/wiki/Municipio), en el Nomenclator hay [entidades colectivas](https://es.wikipedia.org/wiki/Entidad_colectiva_de_poblaci%C3%B3n), [entidades singulares](https://es.wikipedia.org/wiki/Entidad_singular_de_poblaci%C3%B3n), [nucleos](https://es.wikipedia.org/wiki/N%C3%BAcleo_de_poblaci%C3%B3n) y [diseminados](https://es.wikipedia.org/wiki/Diseminado). Como veis no es que sea f√°cil-f√°cil entender los pormenores de estas categor√≠as. Como ejemplo, claro y di√°fano al menos para mi: mi pueblo, Pancrudo, es una entidad singular y un n√∫cleo que pertenece al municipio de Pancrudo. Portalrubio, otro pueblo, es otra entidad singular y n√∫cleo del municipio de Pancrudo. Lo mismo ocurre para Cervera del Rinc√≥n y Cuevas de Portalrubio. En el municipio de Pancrudo no hay entidades colectivas ni diseminados.


La verdad es que el procesado de los 11 ficheros me cost√≥ un poquito: menos mal que medio me gusta y me "relaja".^[Yo creo que me gusta y relaja porque es un reto, pero es un reto que s√© que voy a superar y que hay una soluci√≥n "correcta". No es como un gr√°fico que siempre se puede mejorar. Una vez has procesado los datos ya est√°, no hay m√°s que hacer, es un problema que tiene una "soluci√≥n cerrada". Adem√°s durante el proceso tienes a alguien, el INE, con el que cabrearte por no haber pensado m√°s en que sus datos sean m√°s f√°cilmente reutilizables. Todo ventajas!!]


### Habitantes de mi pueblo

Ahora que he procesado los datos del Nomenclator, ya puedo hacer un gr√°fico con la evoluci√≥n de los habitantes de mi pueblo y ya que me pongo la hago de los cuatro pueblos del municipio de Pancrudo.

```{r, eval = FALSE, echo = TRUE, code_folding = TRUE}
library(tidyverse)
nomenclator <- readr::read_csv("/home/pjpv/Escritorio/my_datos_2021/datos/INE/nomenclator/ine_nomenclator_2010_2020.csv")

pancrudo <- nomenclator %>% filter(ine_muni.n == "Pancrudo") %>% 
  filter(tipo == "Entidad singular") %>% 
  filter(poblacion == "Total") %>% 
  mutate(year1 = as.character(year)) %>% 
  mutate(name = as_factor(case_when(
    name == "PANCRUDO" ~ "Pancrudo",
    name %in% c("CERVERA DEL RINCON", "CERVERA DEL RINC√ìN") ~ "Cervera del Rinc√≥n",
    name == "PORTALRUBIO" ~ "Portalrubio",
    name == "CUEVAS DE PORTALRUBIO" ~ "Cuevas de Portalrubio"))) %>% 
  mutate(name = fct_relevel(name, c("Pancrudo", "Portalrubio", "Cervera del Rinc√≥n", "Cuevas de Portalrubio")))

pancrudo_2020 <- pancrudo %>% filter(year == 2020) %>% select(year, year1, name, values)

p <- ggplot() + 
  #geom_point(data = pancrudo, aes(x = year1, y = values, color = name)) +
  geom_line(data = pancrudo, aes(x = year1, y = values, color = name, group = name), size = 1.5) +
  geom_label(data = pancrudo, aes(x = year1, y = values, label = values)) +
  #geom_text(data = pancrudo_2020, aes( x = year1, y = values,label = name), nudge_x = 1, check_overlap = TRUE, hjust = 0.5) +
  scale_color_manual(name = NULL,  values = c("blueviolet", "deeppink2", "cadetblue4", "brown1")) +
  labs(title = "Evoluci√≥n de la poblaci√≥n de los 4 pueblos del municipio de Pancrudo",
       subtitle = "",
       x = NULL,
       y = "Habitantes",
       caption = "Datos de poblaci√≥n del Nomenclator del INE.Visualizaci√≥n: @pjpv4444", 
       color = NULL) +
  theme(plot.title = element_text(size = 16, face = "bold"),
        legend.position = "none") +
  annotate(geom = "text", x = 11.75, y = 81.2, label ="Pancrudo", color = "black", size = 5) +
  annotate(geom = "text", x = 11.75, y = 18.5, label ="Portalrubio", color = "black", size = 5) +
  annotate(geom = "text", x = 12.135, y = 13.2, label ="Cervera del Rinc√≥n", color = "black", size = 5) +
  annotate(geom = "text", x = 12.24, y = 6.8, label ="Cuevas de Portalrubio", color = "black", size = 5) +
  scale_x_discrete(expand = expansion(mult = c(0.04, .225))) +
  theme_minimal() + theme(plot.title = element_text(size = 16, face = "bold"),
    legend.position = "none",
    text = element_text(family = "Ubuntu Regular", color = "#22211d"),
    plot.background = element_rect(fill = "ghostwhite", color = NA),
    plot.caption = element_text(hjust = 0.05))
p
#- para guardar el plot
ggsave(p, filename = here::here("evolucion_poblacion_pancrudo.png"),
       device = "png", width = 32, height = 20, units = "cm")

```

```{r, echo = FALSE, layout="l-body-outset"}
knitr::include_graphics("./imagenes/evolucion_poblacion_pancrudo.png")
```

Como veis Pancrudo es peque√±ito, pero es la capital del municipio. En 2015 llegamos a un m√≠nimo de 66 habitantes pero parece que recuperamos. Cuevas, Cervera y PÔ∏èortalrubio tambi√©n intentan mantenerse. √Ånimo!! üí™üèø‚¨Ü


### Algunas curiosidades

Ya que tengo los datos del Nomenclator operativos me ha entrado curiosidad por conocer algunas cosas y ver si por fin entend√≠a lo que es una entidad colectiva, una entidad singular, un n√∫cleo y un diseminado. Al final medio lo entend√≠ usando los datos de Pancrudo. Pancrudo es un municipio compuesto por 4 entidades singulares, pero adem√°s esas 4 entidades singulares son n√∫cleos, no son diseminados. Lo que no s√© seguro es si una entidad singular puede tener un n√∫cleo y adem√°s uno o varios diseminados, creo que s√≠, pero ya me cans√© de los datos.

Curiosidades:

- ¬øQu√© municipio tiene m√°s entidades colectivas, singulares, n√∫cleos y diseminados?

```{r, eval = FALSE}
#- CURIOSIDADES ------------------------
#- municipios con mas entidades colectivas etc ...
df <- nomenclator %>% filter(poblacion == "Total") %>% filter(year == 2020)

zz_colectivas <- df %>% filter(tipo == "Entidad colectiva") %>% 
  group_by(ine_muni) %>% mutate(NN = n()) %>% 
  select(ine_muni, ine_muni.n, ine_prov.n, NN) %>% distinct()
zz_Lugo <- df %>% filter(ine_muni == 27028) %>% filter(tipo == "Entidad colectiva")

zz_singulares <- df %>% filter(tipo == "Entidad singular") %>% 
  group_by(ine_muni) %>% mutate(NN = n()) %>% 
  select(ine_muni, ine_muni.n, ine_prov.n, NN) %>% distinct()
zz_Mieres <- df %>% filter(ine_muni == 33037) %>% filter(tipo == "Entidad singular")
janitor::tabyl(zz_Mieres, values)

zz_nucleos <- df %>% filter(tipo == "Nucleo") %>% 
  group_by(ine_muni) %>% mutate(NN = n()) %>% 
  select(ine_muni, ine_muni.n, ine_prov.n, NN) %>% distinct()

zz_diseminados <- df %>% filter(tipo == "Diseminado") %>% 
  group_by(ine_muni) %>% mutate(NN = n()) %>% 
  select(ine_muni, ine_muni.n, ine_prov.n, NN) %>% distinct()
zz_Villalba <- df %>% filter(ine_muni == 27065)
```

Pues resulta que en 2020 el municipio con m√°s [entidades colectivas](https://es.wikipedia.org/wiki/Entidad_colectiva_de_poblaci%C3%B3n) era Lugo con 54. En cuanto a entidades singulares gana Mieres, en Asturias, con 520, ^[No me lo puedo creer 520!!], y 140 de ellos con cero habitantes. Ahora si que no entiendo nada!! N√∫cleos: en n√∫cleos, Vigo en cabeza con 292. Por √∫ltimo diseminados: Villaba, municipio de Lugo, con 446. Parece incre√≠ble, pero es real!!

- Quer√≠a ver si estos datos sirven para enlazar series de poblaci√≥n de  municipios que han sufrido segregaciones. La respuesta es s√≠. Por ejemplo, en el a√±o 2019, El Palmar de Troya se segreg√≥ del municipio de Utrera. Ve√°moslo en un gr√°fico:^[Iba a hacerlo pero ... shit happens y lo tengo que dejar, creo que ya vale con el Nomenclator!!! S√≠.]

```{r, eval = FALSE}
#- EL Palmar de Troya
df <- nomenclator %>% filter(poblacion == "Total") 
my_codes <- c("41095000000", "41904000000", "41095000201")
zz <- df %>% filter(code %in% my_codes)
```





